<!DOCTYPE html>
<html lang="en">

<head>
  <script src="https://cdn.jsdelivr.net/npm/vue@2/dist/vue.js"></script>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Document</title>
</head>

<body style="background-color: #666">
  <div id="app">
    <!-- Page (Add Players) -->
    <div v-if="currentPage == PAGE.PLAYERS">
      <input v-model="playerNameInput" type="text" placeholder="Spielername eingeben" />
      <button v-on:click="addPlayer">Add Player</button>
      <ul>
        <li v-for="player in players">{{ player.name }}</li>
      </ul>
      <button v-if="players.length >= 3" v-on:click="goToErgebnis">
        Start Game
      </button>
    </div>

    <!-- Page (Reizen) -->
    <div v-if="currentPage == PAGE.REIZEN">
      <input v-model="reizzahlInput" type="number" placeholder="Reizzahl eingeben" />
      <select v-model="selectedPlayerId">
        <option disabled value="0">Select player</option>
        <option v-for="player in players" :value="player.id">
          {{ player.name }}
        </option>
      </select>
      <button :disabled="reizzahlInput <= 0" v-on:click="goToMelden">
        Save Reizzahl
      </button>
    </div>

    <!-- Page (Melden) -->
    <div v-if="currentPage == PAGE.MELDEN">
      <h1>Meldezahl eingeben</h1>
      <p v-for="player in players">{{player.name}}
        <input :id="player.id" value="" type="number" v-model="player.rounds[currentRound].meldezahl" placeholder="Meldezahl eingeben"/>
      </p>
      <button v-on:click="goToErzielt">
        Save Meldezahl
      </button>
    </div>

    <!-- Page (Erzielt) -->
    <div v-if="currentPage == PAGE.ERZIELT">
      <h1>Erzielte Punkte eingeben</h1>
      <p v-for="player in players">{{player.name}}
        <input :id="player.id" value="" type="number" v-model="player.rounds[currentRound].erzielt" placeholder="Erzielte Punkte eingeben"/>
      </p>
      <button v-on:click="goToErgebnis">
        Save Erzielte Punkte
      </button>
    </div>

    <!-- Page (Ergebnis) -->
    <div v-if="currentPage == PAGE.ERGEBNIS">
      <table>
        <tr>
          <th>Round</th>
          <th v-for="player in players">{{player.name}}</th>
        </tr>
        <tr v-for="">
          <td>R1</td>
          <td>{{}}</td>
          <td>Summe Punkte R1 Spieler 2</td>
        </tr>       
      </table>
    </div>

  </div>
  <script>

    var app = new Vue({
      el: "#app",
      data: {
        PAGE: {
          PLAYERS: "PlayerInput",
          REIZEN: "ReizenInput",
          MELDEN: "MeldenInput",
          ERZIELT: "ErzieltePunkteInput",
          ERGEBNIS: "ErgebnisOutput",
        },
        playerId: 0,
        currentPage: "PlayerInput",
        currentRound: 0,
        players: [],
        playerNameInput: "",
        reizzahlInput: 0,
        selectedPlayerId: 0,
        rounds: {},
      },
      methods: {
        addPlayer: function () {
          this.players.push({
            id: (this.playerId += 1),
            name: this.playerNameInput,
            rounds: [],
          });
        },
        goToMelden: function () {
          const newPlayers = [];
          for (player of this.players) {
            if (player.id === this.selectedPlayerId) {
              player.rounds.push({ reizzahl: Number(this.reizzahlInput) });
            } else {
              player.rounds.push({ reizzahl: 0 });
            }
            newPlayers.push(player);
          }
          this.currentPage = this.PAGE.MELDEN
        },
        goToReizen: function () {
          this.currentPage = this.PAGE.REIZEN;
        },
        goToErzielt: function () {
          this.currentPage = this.PAGE.ERZIELT;
        },
        goToErgebnis: function () {
          this.currentPage = this.PAGE.ERGEBNIS;
          //R1: ID1 10, ID2 20, ID 30
          const rounds ={
          //   R1: [
          //     {ID:1, Sum:0},
          //     {ID:1, Sum:0}
          // ]
          }
          rounds.R1=[]
          for (const player of this.players) {
            const id=player.id
            const sumR1P1= player.rounds[0].meldezahl + player.rounds[0].erzielt
            const currentPlayerRound = {
              "ID":id,
              "Sum":sumR1P1
            }
            rounds.R1.push(currentPlayerRound)
          }
          
          // TODO: currentRound erh√∂hen
        },
      },
    });
  </script>
</body>

</html>